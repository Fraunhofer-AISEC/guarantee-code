Implementation taken from https://github.com/BLAKE3-team/BLAKE3/
